// Generated by CoffeeScript 1.6.3
(function() {
  var Plugin;

  exports.Plugin = Plugin = (function() {
    "use strict";
    function Plugin() {
      this.el || (this.el = this._createPluginEl());
      this._checkIsInstalled();
    }

    Plugin.prototype.softwareVersion = function() {
      return this.el.getPluginVersion();
    };

    Plugin.prototype._createPluginEl = function() {
      if (this._smellsLikeIE()) {
        return this._createIEPlugin();
      } else {
        return this._createVanillaPlugin();
      }
    };

    Plugin.prototype._checkIsInstalled = function() {
      if (this.el.Unlock == null) {
        throw new Error("Garmin Communicator plugin not installed");
      }
    };

    Plugin.prototype._smellsLikeIE = function() {
      return window.ActiveXObject != null;
    };

    Plugin.prototype._createVanillaPlugin = function() {
      var comm, comm_wrapper;
      comm_wrapper = document.createElement('div');
      comm_wrapper.style.width = 0;
      comm_wrapper.style.height = 0;
      comm = document.createElement('object');
      comm.id = "GarminNetscapePlugin";
      comm.height = 0;
      comm.width = 0;
      comm.setAttribute("type", "application/vnd-garmin.mygarmin");
      comm_wrapper.appendChild(comm);
      document.body.appendChild(comm_wrapper);
      return comm;
    };

    Plugin.prototype._createIEPlugin = function() {
      var comm;
      comm = document.createElement('object');
      comm.id = "GarminActiveXControl";
      comm.style.width = 0;
      comm.style.height = 0;
      comm.style.visibility = "hidden";
      comm.height = 0;
      comm.width = 0;
      comm.setAttribute("classid", "CLSID:099B5A62-DE20-48C6-BF9E-290A9D1D8CB5");
      document.body.appendChild(comm);
      return comm;
    };

    return Plugin;

  })();

}).call(this);

/*
//@ sourceMappingURL=plugin.map
*/
