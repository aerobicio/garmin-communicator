{"version":3,"sources":["webpackBootstrap c24d251249f2998a8766","./compile/src/garmin.js","./compile/src/communicator.js","./compile/src/plugin.js","./compile/src/utils/xmlparser.js","./compile/src/device.js","./compile/src/device/reader.js","./compile/src/device/accessor.js","./compile/src/workouts/fit_workout_factory.js","./compile/src/workouts/tcx_workout_factory.js","./compile/src/workouts/workout_factory.js","./compile/src/workouts/fit_workout.js","./compile/src/workouts/tcx_workout.js"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4B;;;;;;;;;;;;;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,EAAC;A;;;;;;AClDD;AACA;AACA,+BAA8B,mBAAmB,gCAAgC,GAAG,EAAE;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,IAAG;AACH;AACA,EAAC;A;;;;;;AC/ID;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,EAAC;A;;;;;;AClED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,EAAC;A;;;;;;ACpDD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,EAAC;A;;;;;;ACjID;AACA;AACA,mBAAkB;AAClB,0CAAyC,0BAA0B,2DAA2D,EAAE,kBAAkB,0BAA0B,EAAE,mCAAmC,8BAA8B,oCAAoC,cAAc;AACjS;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,EAAC;A;;;;;;AC1ED;AACA;AACA,+BAA8B,mBAAmB,gCAAgC,GAAG;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,EAAC;A;;;;;;ACrHD;AACA;AACA,+BAA8B,mBAAmB,gCAAgC,GAAG,EAAE;AACtF,mBAAkB;AAClB,0CAAyC,0BAA0B,2DAA2D,EAAE,kBAAkB,0BAA0B,EAAE,mCAAmC,8BAA8B,oCAAoC,cAAc;AACjS;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,EAAC;A;;;;;;ACjED;AACA;AACA,+BAA8B,mBAAmB,gCAAgC,GAAG,EAAE;AACtF,mBAAkB;AAClB,0CAAyC,0BAA0B,2DAA2D,EAAE,kBAAkB,0BAA0B,EAAE,mCAAmC,8BAA8B,oCAAoC,cAAc;AACjS;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,EAAC;A;;;;;;ACnDD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,EAAC;A;;;;;;AChCD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,EAAC;A;;;;;;AC/BD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,EAAC;A","sourcesContent":["\n// The module cache\nvar installedModules = {};\n\n// The require function\nfunction require(moduleId) {\n\t// Check if module is in cache\n\tif(installedModules[moduleId])\n\t\treturn installedModules[moduleId].exports;\n\t\n\t// Create a new module (and put it into the cache)\n\tvar module = installedModules[moduleId] = {\n\t\texports: {},\n\t\tid: moduleId,\n\t\tloaded: false\n\t};\n\t\n\t// Execute the module function\n\tmodules[moduleId].call(module.exports, module, module.exports, require);\n\t\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\t\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// The bundle contains no chunks. A empty chunk loading function.\nrequire.e = function requireEnsure(_, callback) {\n\tcallback.call(null, this);\n};\n\n// expose the modules object (__webpack_modules__)\nrequire.modules = modules;\n\n// expose the module cache\nrequire.cache = installedModules;\n\n// __webpack_public_path__\nrequire.p = \"\";\n\n\n// Load entry module and return exports\nreturn require(0);","(function() {\n  var Communicator, Garmin;\n\n  Communicator = require('./communicator').Communicator;\n\n  window.Garmin = Garmin = (function() {\n    \"use strict\";\n    Garmin.prototype.DEFAULT_UNLOCK_CODES = {\n      \"file:///\": \"cb1492ae040612408d87cc53e3f7ff3c\",\n      \"http://localhost\": \"45517b532362fc3149e4211ade14c9b2\",\n      \"http://127.0.0.1\": \"40cd4860f7988c53b15b8491693de133\"\n    };\n\n    function Garmin(options) {\n      if (options == null) {\n        options = {};\n      }\n      this.configuration = _(options).defaults({\n        unlockCodes: this.mergeUnlockCodes(options.unlockCodes),\n        testMode: false\n      });\n      this.communicator = Communicator.get(this.configuration);\n      this.unlock();\n    }\n\n    Garmin.prototype.mergeUnlockCodes = function(unlockCodes) {\n      if (unlockCodes == null) {\n        unlockCodes = {};\n      }\n      return _(this.DEFAULT_UNLOCK_CODES).defaults(unlockCodes);\n    };\n\n    Garmin.prototype.isInstalled = function() {\n      return this.isInstalled = this.communicator.pluginIsInstalled || this.configuration.testMode;\n    };\n\n    Garmin.prototype.unlock = function() {\n      if (!this.configuration.testMode) {\n        return this.communicator.unlock(this.configuration.unlockCodes);\n      }\n    };\n\n    Garmin.prototype.devices = function() {\n      return this.communicator.devices();\n    };\n\n    return Garmin;\n\n  })();\n\n}).call(this);\n","(function() {\n  var Communicator, Plugin, XMLParser,\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n    __slice = [].slice;\n\n  Plugin = require('./plugin').Plugin;\n\n  XMLParser = require('./utils/xmlparser').XMLParser;\n\n  exports.Communicator = Communicator = (function() {\n    \"use strict\";\n    var PrivateCommunicator, _configuration, _instance;\n\n    function Communicator() {}\n\n    _configuration = null;\n\n    _instance = null;\n\n    Communicator.get = function(configuration) {\n      if (configuration) {\n        _configuration = configuration;\n      }\n      return _instance || (_instance = new PrivateCommunicator(_configuration));\n    };\n\n    Communicator.destroy = function() {\n      _instance = null;\n    };\n\n    PrivateCommunicator = (function() {\n      PrivateCommunicator.prototype.pluginIsInstalled = null;\n\n      function PrivateCommunicator(configuration) {\n        this.devices = __bind(this.devices, this);\n        this.configuration = configuration;\n        this.plugin = new Plugin();\n        this.pluginIsInstalled = this.plugin.pluginIsInstalled();\n        this.pluginProxy = this.plugin.el;\n      }\n\n      PrivateCommunicator.prototype.invoke = function() {\n        var args, fn, name;\n        name = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n        fn = this.pluginProxy[name];\n        if ((fn != null) && typeof fn === 'function') {\n          return fn.apply(this.pluginProxy, args);\n        } else {\n          throw new Error(\"'\" + name + \"' function does not exist!\");\n        }\n      };\n\n      PrivateCommunicator.prototype.write = function(name, data) {\n        if (this.pluginProxy.hasOwnProperty(name)) {\n          this.pluginProxy[name] = data;\n          return true;\n        } else {\n          return false;\n        }\n      };\n\n      PrivateCommunicator.prototype.read = function(name) {\n        if (this.pluginProxy.hasOwnProperty(name)) {\n          return this.pluginProxy[name];\n        } else {\n          return false;\n        }\n      };\n\n      PrivateCommunicator.prototype.busy = function(value) {\n        if (value != null) {\n          this._busy = value;\n        }\n        return this._busy || false;\n      };\n\n      PrivateCommunicator.prototype.isLocked = function() {\n        return this.pluginProxy.Locked;\n      };\n\n      PrivateCommunicator.prototype.unlock = function(unlockCodes) {\n        var unlocked,\n          _this = this;\n        if (this.isLocked()) {\n          unlocked = false;\n          _(unlockCodes).map(function(unlockKey, domain) {\n            return unlocked || (unlocked = _this.invoke('Unlock', domain, unlockKey));\n          });\n          return unlocked;\n        }\n      };\n\n      PrivateCommunicator.prototype.devices = function() {\n        var deferred,\n          _this = this;\n        if (!this.busy()) {\n          this.busy(true);\n          this.unlock();\n          deferred = Q.defer();\n          deferred.promise[\"finally\"](function() {\n            return _this.busy(false);\n          });\n          this._findDevices(deferred);\n          return deferred.promise;\n        }\n      };\n\n      PrivateCommunicator.prototype._findDevices = function(deferred) {\n        this.invoke('StartFindDevices');\n        return this._loopUntilFinishedFindingDevices(deferred);\n      };\n\n      PrivateCommunicator.prototype._loopUntilFinishedFindingDevices = function(deferred) {\n        var _this = this;\n        if (this.invoke('FinishFindDevices')) {\n          return deferred.resolve(this._parseDeviceXml());\n        } else {\n          return setTimeout((function() {\n            return _this._loopUntilFinishedFindingDevices(deferred);\n          }), 100);\n        }\n      };\n\n      PrivateCommunicator.prototype._parseDeviceXml = function() {\n        var Device, xml;\n        Device = require('./device').Device;\n        xml = XMLParser.parse(this.invoke('DevicesXmlString'));\n        return _(xml.getElementsByTagName(\"Device\")).map(function(device) {\n          var name, number;\n          name = device.getAttribute(\"DisplayName\");\n          number = parseInt(device.getAttribute(\"Number\"), 10);\n          return new Device(number, name);\n        });\n      };\n\n      return PrivateCommunicator;\n\n    })();\n\n    return Communicator;\n\n  }).call(this);\n\n}).call(this);\n","(function() {\n  var Plugin;\n\n  exports.Plugin = Plugin = (function() {\n    \"use strict\";\n    function Plugin() {\n      this.el || (this.el = this._createPluginEl());\n    }\n\n    Plugin.prototype.softwareVersion = function() {\n      return this.el.getPluginVersion();\n    };\n\n    Plugin.prototype._createPluginEl = function() {\n      if (this._smellsLikeIE()) {\n        return this._createIEPlugin();\n      } else {\n        return this._createVanillaPlugin();\n      }\n    };\n\n    Plugin.prototype.pluginIsInstalled = function() {\n      if (this.el.Unlock != null) {\n        return true;\n      } else {\n        return false;\n      }\n    };\n\n    Plugin.prototype._smellsLikeIE = function() {\n      return window.ActiveXObject != null;\n    };\n\n    Plugin.prototype._createVanillaPlugin = function() {\n      var comm, comm_wrapper;\n      comm_wrapper = document.createElement('div');\n      comm_wrapper.style.width = 0;\n      comm_wrapper.style.height = 0;\n      comm = document.createElement('object');\n      comm.id = \"GarminNetscapePlugin\";\n      comm.height = 0;\n      comm.width = 0;\n      comm.setAttribute(\"type\", \"application/vnd-garmin.mygarmin\");\n      comm_wrapper.appendChild(comm);\n      document.body.appendChild(comm_wrapper);\n      return comm;\n    };\n\n    Plugin.prototype._createIEPlugin = function() {\n      var comm;\n      comm = document.createElement('object');\n      comm.id = \"GarminActiveXControl\";\n      comm.style.width = 0;\n      comm.style.height = 0;\n      comm.style.visibility = \"hidden\";\n      comm.height = 0;\n      comm.width = 0;\n      comm.setAttribute(\"classid\", \"CLSID:099B5A62-DE20-48C6-BF9E-290A9D1D8CB5\");\n      document.body.appendChild(comm);\n      return comm;\n    };\n\n    return Plugin;\n\n  })();\n\n}).call(this);\n","(function() {\n  var XMLParser;\n\n  exports.XMLParser = XMLParser = (function() {\n    \"use strict\";\n    function XMLParser() {}\n\n    XMLParser.parse = function(xml) {\n      if (this._parser == null) {\n        this._getParser();\n      }\n      if (typeof xml !== \"string\") {\n        throw new Error(\"XML is not a string!\");\n      }\n      return this._parser(xml);\n    };\n\n    XMLParser._getParser = function() {\n      return this._parser = (function() {\n        if (this._domParserAvailable()) {\n          return this._domParser;\n        } else if (this._xmlDomAvailable()) {\n          return this._xmlDomParser;\n        } else {\n          throw new Error(\"No XML parser found, can't parse XML\");\n        }\n      }).call(this);\n    };\n\n    XMLParser._domParserAvailable = function() {\n      return window.DOMParser != null;\n    };\n\n    XMLParser._xmlDomAvailable = function() {\n      return (window.ActiveXObject != null) && (typeof window.ActiveXObject === \"function\" ? window.ActiveXObject(\"Microsoft.XMLDOM\") : void 0);\n    };\n\n    XMLParser._domParser = function(xml) {\n      return new window.DOMParser().parseFromString(xml, \"text/xml\");\n    };\n\n    XMLParser._xmlDomParser = function(xml) {\n      var xmlDoc;\n      xmlDoc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n      xmlDoc.async = \"false\";\n      return xmlDoc.loadXML(xml);\n    };\n\n    return XMLParser;\n\n  })();\n\n}).call(this);\n","(function() {\n  var Communicator, Device, Reader, XMLParser;\n\n  Communicator = require('./communicator').Communicator;\n\n  Reader = require('./device/reader').Reader;\n\n  XMLParser = require('./utils/xmlparser').XMLParser;\n\n  exports.Device = Device = (function() {\n    \"use strict\";\n    Device.prototype.ACTIONS = {\n      Activities: ['FitnessHistory', 'FitnessDirectory'],\n      Workouts: ['FitnessWorkouts', 'FitnessData'],\n      Courses: ['FitnessCourses', 'FitnessData'],\n      Goals: ['FitnessActivityGoals', 'FitnessData'],\n      Profile: ['FitnessUserProfile', 'FitnessData'],\n      FITActivities: ['FIT_TYPE_4', 'FITDirectory']\n    };\n\n    function Device(number, name) {\n      this.number = number;\n      this.name = name;\n      this.communicator = Communicator.get();\n      this.deviceDescriptionXml = this._getDeviceDescriptionXml();\n      this._setDeviceInfo();\n      this._setDeviceCapabilities();\n      this._createDeviceAccessors();\n    }\n\n    Device.prototype.activities = function() {\n      if (this.canReadFITActivities) {\n        return this.readFITActivities();\n      } else {\n        return this.readActivities();\n      }\n    };\n\n    Device.prototype._setDeviceCapabilities = function() {\n      return _.each(this.ACTIONS, function(data, type) {\n        this[\"canRead\" + type] = this._canXY('Output', data[0]);\n        return this[\"canWrite\" + type] = this._canXY('Input', data[0]);\n      }, this);\n    };\n\n    Device.prototype._createDeviceAccessors = function() {\n      return _.each(this.ACTIONS, function(data, type) {\n        this[\"read\" + type] = this._reader(type, data[0], data[1]);\n        return this[\"write\" + type] = this._writer();\n      }, this);\n    };\n\n    Device.prototype._reader = function(type, dataType, pluginMethod) {\n      return function() {\n        var reader;\n        if (!this[\"canRead\" + type]) {\n          throw new Error(\"read\" + type + \" is not supported on this device\");\n        }\n        reader = new Reader(this, dataType, pluginMethod);\n        return reader.perform();\n      };\n    };\n\n    Device.prototype._writer = function() {\n      return function() {\n        throw new Error(\"Not implemented\");\n      };\n    };\n\n    Device.prototype._canXY = function(method, dataTypeName) {\n      var transferDirection, _ref, _ref1;\n      transferDirection = (_ref = this._getDataTypeNodeForDataTypeName(dataTypeName)) != null ? (_ref1 = _ref.getElementsByTagName(\"File\")[0]) != null ? _ref1.getElementsByTagName(\"TransferDirection\")[0].textContent : void 0 : void 0;\n      return (transferDirection != null) && new RegExp(method).test(transferDirection);\n    };\n\n    Device.prototype._getDataTypeNodeForDataTypeName = function(name) {\n      var dataTypesXml;\n      dataTypesXml = this._getDeviceDataTypesXml();\n      if (dataTypesXml) {\n        return _.filter(dataTypesXml, function(node) {\n          return name === node.getElementsByTagName(\"Name\")[0].textContent;\n        })[0];\n      }\n    };\n\n    Device.prototype._getDeviceDataTypesXml = function() {\n      var _ref, _ref1;\n      return this._deviceDataTypes || (this._deviceDataTypes = (_ref = this.deviceDescriptionXml) != null ? (_ref1 = _ref.getElementsByTagName(\"MassStorageMode\")[0]) != null ? _ref1.getElementsByTagName(\"DataType\") : void 0 : void 0);\n    };\n\n    Device.prototype._setDeviceInfo = function() {\n      this.id = this._deviceId();\n      this.name = this._deviceDisplayName();\n      this.partNumber = this._devicePartNumber();\n      return this.softwareVersion = this._softwareVersion();\n    };\n\n    Device.prototype._getDeviceDescriptionXml = function() {\n      var xml;\n      xml = this.communicator.invoke('DeviceDescription', this.number);\n      return XMLParser.parse(xml);\n    };\n\n    Device.prototype._deviceId = function() {\n      return this.deviceDescriptionXml.getElementsByTagName(\"Id\")[0].textContent;\n    };\n\n    Device.prototype._deviceDisplayName = function() {\n      var model;\n      model = this.deviceDescriptionXml.getElementsByTagName(\"Model\")[0];\n      if (model.getElementsByTagName(\"DisplayName\").length) {\n        return model.getElementsByTagName(\"DisplayName\")[0].textContent;\n      } else {\n        return model.getElementsByTagName(\"Description\")[0].textContent;\n      }\n    };\n\n    Device.prototype._devicePartNumber = function() {\n      return this.deviceDescriptionXml.getElementsByTagName(\"Model\")[0].getElementsByTagName(\"PartNumber\")[0].textContent;\n    };\n\n    Device.prototype._softwareVersion = function() {\n      return this.deviceDescriptionXml.getElementsByTagName(\"Model\")[0].getElementsByTagName(\"SoftwareVersion\")[0].textContent;\n    };\n\n    return Device;\n\n  })();\n\n}).call(this);\n","(function() {\n  var Accessor, Communicator, FitWorkoutFactory, Reader, TcxWorkoutFactory, _ref,\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n  Communicator = require('../communicator').Communicator;\n\n  Accessor = require('./accessor').Accessor;\n\n  FitWorkoutFactory = require('../workouts/fit_workout_factory').FitWorkoutFactory;\n\n  TcxWorkoutFactory = require('../workouts/tcx_workout_factory').TcxWorkoutFactory;\n\n  exports.Reader = Reader = (function(_super) {\n    __extends(Reader, _super);\n\n    \"use strict\";\n\n    function Reader() {\n      _ref = Reader.__super__.constructor.apply(this, arguments);\n      return _ref;\n    }\n\n    Reader.prototype.ACTION = \"Read\";\n\n    Reader.prototype.perform = function() {\n      this.clearDeviceXmlBuffers();\n      Reader.__super__.perform.apply(this, arguments);\n      return this.deferred.promise;\n    };\n\n    Reader.prototype.clearDeviceXmlBuffers = function() {\n      this.communicator.write(\"TcdXml\", \"\");\n      return this.communicator.write(\"DirectoryListingXml\", \"\");\n    };\n\n    Reader.prototype._onFinished = function(deferred) {\n      deferred.notify({\n        percent: 100\n      });\n      return deferred.resolve(this.handleFinishedReading());\n    };\n\n    Reader.prototype.handleFinishedReading = function() {\n      switch (this.pluginMethod) {\n        case 'FITDirectory':\n          return this.handleReadFITDirectory();\n        case 'FitnessDirectory':\n          return this.handleReadFitnessDirectory();\n        case 'FitnessDetail':\n          return this.handleReadFitnessDetail();\n      }\n    };\n\n    Reader.prototype.handleReadFITDirectory = function() {\n      var data;\n      data = this.communicator.read(\"DirectoryListingXml\");\n      return new FitWorkoutFactory(this.device).produce(data);\n    };\n\n    Reader.prototype.handleReadFitnessDirectory = function() {\n      var data;\n      data = this.communicator.read(\"TcdXml\");\n      return new TcxWorkoutFactory(this.device).produce(data);\n    };\n\n    Reader.prototype.handleReadFitnessDetail = function() {\n      return this.communicator.read(\"TcdXml\");\n    };\n\n    return Reader;\n\n  })(Accessor);\n\n}).call(this);\n","(function() {\n  var Accessor, Communicator, XMLParser,\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\n  Communicator = require('../communicator').Communicator;\n\n  XMLParser = require('../utils/xmlparser').XMLParser;\n\n  exports.Accessor = Accessor = (function() {\n    \"use strict\";\n    Accessor.prototype.PERCENT_REGEX = /^[0-9]+%/;\n\n    Accessor.prototype.STATUS_CODES = {\n      idle: 0,\n      working: 1,\n      waiting: 2,\n      finished: 3\n    };\n\n    function Accessor(device, dataType, pluginMethod) {\n      this.device = device;\n      this.dataType = dataType;\n      this.pluginMethod = pluginMethod;\n      this._checkFinished = __bind(this._checkFinished, this);\n      this.communicator = Communicator.get();\n      this.pluginAction = \"\" + this.ACTION + this.pluginMethod;\n    }\n\n    Accessor.prototype.perform = function() {\n      var args, argsArray;\n      this.deferred = Q.defer();\n      if (this.communicator.busy()) {\n        throw new Error(\"Plugin is busy\");\n      }\n      argsArray = Array.prototype.slice.call(arguments, 0);\n      args = [this._startPluginAction(), this.device.number, this.dataType].concat(argsArray);\n      this.communicator.invoke.apply(this.communicator, args);\n      this._checkFinished(this.deferred);\n      return this.deferred.promise;\n    };\n\n    Accessor.prototype._startPluginAction = function() {\n      return \"Start\" + this.pluginAction;\n    };\n\n    Accessor.prototype._finishPluginAction = function() {\n      return \"Finish\" + this.pluginAction;\n    };\n\n    Accessor.prototype._checkFinished = function(deferred) {\n      switch (this.communicator.invoke(this._finishPluginAction())) {\n        case this.STATUS_CODES.working:\n          return this._onWorking(deferred);\n        case this.STATUS_CODES.finished:\n          return this._onFinished(deferred);\n        case this.STATUS_CODES.waiting:\n          return this._onWaiting(deferred);\n        case this.STATUS_CODES.idle:\n          return this._onIdle(deferred);\n        default:\n          throw new Error(\"Unexpected Velociraptor.\");\n      }\n    };\n\n    Accessor.prototype._onWorking = function(deferred) {\n      var _this = this;\n      deferred.notify(this._progress());\n      return setTimeout((function() {\n        return _this._checkFinished(deferred);\n      }), 100);\n    };\n\n    Accessor.prototype._onWaiting = function(deferred) {\n      var _this = this;\n      return setTimeout((function() {\n        return _this._checkFinished(deferred);\n      }), 150);\n    };\n\n    Accessor.prototype._onIdle = function(deferred) {\n      return deferred.reject();\n    };\n\n    Accessor.prototype._onFinished = function() {\n      throw new Error(\"Abstract method: Not Implemented\");\n    };\n\n    Accessor.prototype._progress = function() {\n      var progress, progressXml, _ref,\n        _this = this;\n      progress = {\n        content: [],\n        percent: 0\n      };\n      progressXml = this._getProgressXml().getElementsByTagName(\"ProgressWidget\")[0];\n      progress.message = (_ref = progressXml.getElementsByTagName(\"Title\")[0]) != null ? _ref.textContent : void 0;\n      _.each(progressXml.getElementsByTagName(\"Text\"), function(node) {\n        if (node.textContent.match(_this.PERCENT_REGEX)) {\n          progress.percent = parseInt(node.textContent, 10);\n        } else {\n          progress.content.push(node.textContent);\n        }\n        return node;\n      });\n      return progress;\n    };\n\n    Accessor.prototype._getProgressXml = function() {\n      var xml;\n      xml = this.communicator.read(\"ProgressXml\");\n      return XMLParser.parse(xml);\n    };\n\n    return Accessor;\n\n  })();\n\n}).call(this);\n","(function() {\n  var FitWorkout, FitWorkoutFactory, WorkoutFactory, XMLParser, _ref,\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n  XMLParser = require('../utils/xmlparser').XMLParser;\n\n  WorkoutFactory = require('./workout_factory').WorkoutFactory;\n\n  FitWorkout = require('./fit_workout').FitWorkout;\n\n  exports.FitWorkoutFactory = FitWorkoutFactory = (function(_super) {\n    __extends(FitWorkoutFactory, _super);\n\n    \"use strict\";\n\n    function FitWorkoutFactory() {\n      this._filterFitFileXmlType = __bind(this._filterFitFileXmlType, this);\n      this._objectForFileNode = __bind(this._objectForFileNode, this);\n      _ref = FitWorkoutFactory.__super__.constructor.apply(this, arguments);\n      return _ref;\n    }\n\n    FitWorkoutFactory.prototype.produce = function(data) {\n      var xml;\n      xml = XMLParser.parse(data);\n      return _.chain(xml.getElementsByTagName(\"File\")).filter(this._filterFitFileXmlType).map(this._objectForFileNode).value();\n    };\n\n    FitWorkoutFactory.prototype._objectForFileNode = function(file) {\n      var date, id, path, type;\n      id = this._getIdForFileNode(file);\n      type = this._getFileTypeForFileNode(file);\n      date = this._getCreationTimeFileNode(file);\n      path = this._getPathForFileNode(file);\n      return new FitWorkout(this.device, id, type, date, path);\n    };\n\n    FitWorkoutFactory.prototype._getCreationTimeFileNode = function(file) {\n      var dateTimeString;\n      dateTimeString = file.getElementsByTagName(\"CreationTime\")[0].textContent;\n      return this._parseISODateString(dateTimeString);\n    };\n\n    FitWorkoutFactory.prototype._filterFitFileXmlType = function(file) {\n      return this._getFileTypeForFileNode(file) === this.FITFILE_TYPES.activities;\n    };\n\n    FitWorkoutFactory.prototype._getIdForFileNode = function(fileXml) {\n      return parseInt(fileXml.getElementsByTagName(\"FitId\")[0].getElementsByTagName(\"Id\")[0].textContent, 10);\n    };\n\n    FitWorkoutFactory.prototype._getFileTypeForFileNode = function(fileXml) {\n      return parseInt(fileXml.getElementsByTagName(\"FitId\")[0].getElementsByTagName(\"FileType\")[0].textContent, 10);\n    };\n\n    FitWorkoutFactory.prototype._getPathForFileNode = function(file) {\n      return file.getAttribute(\"Path\");\n    };\n\n    return FitWorkoutFactory;\n\n  })(WorkoutFactory);\n\n}).call(this);\n","(function() {\n  var TcxWorkout, TcxWorkoutFactory, WorkoutFactory, XMLParser, _ref,\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n  XMLParser = require('../utils/xmlparser').XMLParser;\n\n  WorkoutFactory = require('./workout_factory').WorkoutFactory;\n\n  TcxWorkout = require('./tcx_workout').TcxWorkout;\n\n  exports.TcxWorkoutFactory = TcxWorkoutFactory = (function(_super) {\n    __extends(TcxWorkoutFactory, _super);\n\n    \"use strict\";\n\n    function TcxWorkoutFactory() {\n      this._getFirstLapStartTime = __bind(this._getFirstLapStartTime, this);\n      this._objectForActivityNode = __bind(this._objectForActivityNode, this);\n      _ref = TcxWorkoutFactory.__super__.constructor.apply(this, arguments);\n      return _ref;\n    }\n\n    TcxWorkoutFactory.prototype.produce = function(data) {\n      var xml;\n      xml = XMLParser.parse(data);\n      return _.chain(xml.getElementsByTagName(\"Activity\")).map(this._objectForActivityNode).value();\n    };\n\n    TcxWorkoutFactory.prototype._objectForActivityNode = function(activity) {\n      var date, id;\n      id = this._getIdForActivityNode(activity);\n      date = this._getFirstLapStartTime(activity);\n      return new TcxWorkout(this.device, id, date);\n    };\n\n    TcxWorkoutFactory.prototype._getFirstLapStartTime = function(activity) {\n      var dateTimeString;\n      dateTimeString = activity.getElementsByTagName(\"Lap\")[0].getAttribute(\"StartTime\");\n      return this._parseISODateString(dateTimeString);\n    };\n\n    TcxWorkoutFactory.prototype._getIdForActivityNode = function(activity) {\n      return activity.getElementsByTagName(\"Id\")[0].textContent;\n    };\n\n    return TcxWorkoutFactory;\n\n  })(WorkoutFactory);\n\n}).call(this);\n","(function() {\n  var WorkoutFactory;\n\n  exports.WorkoutFactory = WorkoutFactory = (function() {\n    \"use strict\";\n    WorkoutFactory.prototype.FITFILE_TYPES = {\n      activities: 4,\n      goals: 11,\n      locations: 8,\n      monitoring: 9,\n      profiles: 2,\n      schedules: 7,\n      sports: 3,\n      totals: 10\n    };\n\n    function WorkoutFactory(device) {\n      this.device = device;\n    }\n\n    WorkoutFactory.prototype._parseISODateString = function(dateString) {\n      var formattedDateString;\n      this.REPLACE_DATE_DASHES_REGEX || (this.REPLACE_DATE_DASHES_REGEX = /-/g);\n      this.REPLACE_DATE_TZ_REGEX || (this.REPLACE_DATE_TZ_REGEX = /[TZ]/g);\n      formattedDateString = dateString.replace(this.REPLACE_DATE_DASHES_REGEX, \"/\").replace(this.REPLACE_DATE_TZ_REGEX, \" \");\n      return new Date(formattedDateString);\n    };\n\n    return WorkoutFactory;\n\n  })();\n\n}).call(this);\n","(function() {\n  var Communicator, FitWorkout;\n\n  Communicator = require('../communicator').Communicator;\n\n  exports.FitWorkout = FitWorkout = (function() {\n    \"use strict\";\n    function FitWorkout(device, id, type, date, path) {\n      this.id = id;\n      this.device = device;\n      this.type = type;\n      this.date = date;\n      this.path = path;\n      this.communicator = Communicator.get();\n    }\n\n    FitWorkout.prototype.getData = function() {\n      var deferred;\n      deferred = Q.defer();\n      deferred.resolve(this._getBinaryFile());\n      return deferred.promise;\n    };\n\n    FitWorkout.prototype._getBinaryFile = function() {\n      return this.communicator.invoke(\"GetBinaryFile\", this.device.number, this.path, false);\n    };\n\n    return FitWorkout;\n\n  })();\n\n}).call(this);\n","(function() {\n  var TcxWorkout;\n\n  exports.TcxWorkout = TcxWorkout = (function() {\n    \"use strict\";\n    function TcxWorkout(device, id, date) {\n      var Reader;\n      Reader = require('../device/reader').Reader;\n      this.device = device;\n      this.id = id;\n      this.date = date;\n      this.detailReader = new Reader(this.device, \"FitnessHistory\", \"FitnessDetail\");\n    }\n\n    TcxWorkout.prototype.getData = function() {\n      return this.detailReader.perform(this.id);\n    };\n\n    return TcxWorkout;\n\n  })();\n\n}).call(this);\n"],"sourceRoot":"webpack-module://"}